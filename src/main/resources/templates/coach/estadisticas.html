<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estadísticas - CABA Pro</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="bg-gray-50">
    <div class="flex min-h-screen">
        <!-- Sidebar -->
        <div th:replace="~{fragments/EntrenadorFragments/sideBar :: sideBar('estadisticas')}"></div>
        
        <!-- Main Content -->
        <div class="flex-1 md:ml-64">
            <!-- Top bar -->
            <div th:replace="~{fragments/EntrenadorFragments/upBar :: upBar('Estadísticas', ${entrenador.nombreCompleto})}"></div>
            
            <!-- Content -->
            <div class="p-6">
                <!-- Header -->
                <div class="mb-8">
                    <h1 class="text-3xl font-bold text-gray-900 mb-2">Estadísticas del Equipo</h1>
                    <p class="text-gray-600">Análisis detallado del rendimiento de <span th:text="${entrenador.equipo}">tu equipo</span></p>
                </div>

                <!-- Resumen General -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white p-6 rounded-lg shadow-md text-center">
                        <div class="text-3xl font-bold text-blue-600 mb-2" th:text="${estadisticas['partidosJugados']}">0</div>
                        <div class="text-gray-600 text-sm font-medium">Partidos Jugados</div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg shadow-md text-center">
                        <div class="text-3xl font-bold text-green-600 mb-2" th:text="${estadisticas.partidosGanados}">0</div>
                        <div class="text-gray-600 text-sm font-medium">Victorias</div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg shadow-md text-center">
                        <div class="text-3xl font-bold text-red-600 mb-2" th:text="${estadisticas.partidosPerdidos}">0</div>
                        <div class="text-gray-600 text-sm font-medium">Derrotas</div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg shadow-md text-center">
                        <div class="text-3xl font-bold text-yellow-600 mb-2" th:text="${estadisticas.partidosEmpatados ?: 0}">0</div>
                        <div class="text-gray-600 text-sm font-medium">Empates</div>
                    </div>
                </div>

                <!-- Gráfico de Rendimiento -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                    <!-- Porcentaje de Victorias -->
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">
                            <i class="fas fa-chart-pie mr-2 text-blue-600"></i>Distribución de Resultados
                        </h3>
                        
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <span class="text-green-600 font-medium">Victorias</span>
                                <div class="flex items-center space-x-2">
                                    <div class="w-24 h-2 bg-gray-200 rounded-full">
                                        <div class="h-2 bg-green-500 rounded-full" 
                                             th:style="'width: ' + ${estadisticas.porcentajeVictorias} + '%'"></div>
                                    </div>
                                    <span class="text-sm text-gray-600" th:text="${estadisticas.porcentajeVictorias + '%'}">0%</span>
                                </div>
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <span class="text-red-600 font-medium">Derrotas</span>
                                <div class="flex items-center space-x-2">
                                    <div class="w-24 h-2 bg-gray-200 rounded-full">
                                        <div class="h-2 bg-red-500 rounded-full" 
                                             th:style="'width: ' + ${estadisticas.porcentajeDerrotas ?: 0} + '%'"></div>
                                    </div>
                                    <span class="text-sm text-gray-600" th:text="${estadisticas.porcentajeDerrotas ?: 0} + '%'">0%</span>
                                </div>
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <span class="text-yellow-600 font-medium">Empates</span>
                                <div class="flex items-center space-x-2">
                                    <div class="w-24 h-2 bg-gray-200 rounded-full">
                                        <div class="h-2 bg-yellow-500 rounded-full" 
                                             th:style="'width: ' + ${estadisticas.porcentajeEmpates ?: 0} + '%'"></div>
                                    </div>
                                    <span class="text-sm text-gray-600" th:text="${estadisticas.porcentajeEmpates ?: 0} + '%'">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Promedio de Goles -->
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">
                            <i class="fas fa-basketball-ball mr-2 text-orange-600"></i>Estadísticas de Anotación
                        </h3>
                        
                        <div class="space-y-4">
                            <div class="flex justify-between items-center">
                                <span class="text-gray-600">Promedio de puntos a favor</span>
                                <span class="text-lg font-bold text-blue-600" th:text="${estadisticas.promedioGolesAFavor ?: '0.0'}">0.0</span>
                            </div>
                            
                            <div class="flex justify-between items-center">
                                <span class="text-gray-600">Promedio de puntos en contra</span>
                                <span class="text-lg font-bold text-red-600" th:text="${estadisticas.promedioGolesEnContra ?: '0.0'}">0.0</span>
                            </div>
                            
                            <div class="flex justify-between items-center border-t pt-2">
                                <span class="text-gray-600 font-medium">Diferencia promedio</span>
                                <span class="text-lg font-bold" 
                                      th:classappend="${(estadisticas.diferenciaPuntos ?: 0) >= 0} ? 'text-green-600' : 'text-red-600'"
                                      th:text="${estadisticas.diferenciaPuntos ?: '0.0'}">0.0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Últimos Partidos -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Últimos 5 Partidos -->
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">
                            <i class="fas fa-history mr-2 text-purple-600"></i>Últimos Partidos
                        </h3>
                        
                        <div th:if="${#lists.isEmpty(ultimosPartidos)}" class="text-center text-gray-500 py-4">
                            <i class="fas fa-calendar-times text-3xl mb-2"></i>
                            <p>No hay partidos recientes</p>
                        </div>
                        
                        <div th:unless="${#lists.isEmpty(ultimosPartidos)}" class="space-y-3">
                            <div th:each="partido : ${ultimosPartidos}" 
                                 class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                <div class="flex-1">
                                    <p class="text-sm font-medium text-gray-900">
                                        <span th:text="${partido.equipoLocal}">Local</span> vs 
                                        <span th:text="${partido.equipoVisitante}">Visitante</span>
                                    </p>
                                    <p class="text-xs text-gray-500" th:text="${#temporals.format(partido.fecha, 'dd/MM/yyyy')}">Fecha</p>
                                </div>
                                
                                <div class="text-center">
                                    <span th:if="${partido.marcadorLocal != null and partido.marcadorVisitante != null}"
                                          class="text-sm font-bold"
                                          th:text="${partido.marcadorLocal + '-' + partido.marcadorVisitante}">0-0</span>
                                    <span th:unless="${partido.marcadorLocal != null and partido.marcadorVisitante != null}"
                                          class="text-xs text-gray-400">Sin resultado</span>
                                </div>
                                
                                <div class="ml-2">
                                    <span th:if="${partido.equipoLocal == entrenador.equipo and partido.marcadorLocal > partido.marcadorVisitante}"
                                          class="w-3 h-3 bg-green-500 rounded-full inline-block" title="Victoria"></span>
                                    <span th:if="${partido.equipoVisitante == entrenador.equipo and partido.marcadorVisitante > partido.marcadorLocal}"
                                          class="w-3 h-3 bg-green-500 rounded-full inline-block" title="Victoria"></span>
                                    <span th:if="${partido.marcadorLocal == partido.marcadorVisitante and partido.marcadorLocal != null}"
                                          class="w-3 h-3 bg-yellow-500 rounded-full inline-block" title="Empate"></span>
                                    <span th:if="${(partido.equipoLocal == entrenador.equipo and partido.marcadorLocal < partido.marcadorVisitante) or (partido.equipoVisitante == entrenador.equipo and partido.marcadorVisitante < partido.marcadorLocal)}"
                                          class="w-3 h-3 bg-red-500 rounded-full inline-block" title="Derrota"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Próximos Partidos -->
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">
                            <i class="fas fa-calendar-plus mr-2 text-blue-600"></i>Próximos Partidos
                        </h3>
                        
                        <div th:if="${#lists.isEmpty(proximosPartidos)}" class="text-center text-gray-500 py-4">
                            <i class="fas fa-calendar-alt text-3xl mb-2"></i>
                            <p>No hay partidos programados</p>
                        </div>
                        
                        <div th:unless="${#lists.isEmpty(proximosPartidos)}" class="space-y-3">
                            <div th:each="partido : ${proximosPartidos}" 
                                 class="flex items-center justify-between p-3 bg-blue-50 rounded-lg">
                                <div class="flex-1">
                                    <p class="text-sm font-medium text-gray-900">
                                        <span th:text="${partido.equipoLocal}">Local</span> vs 
                                        <span th:text="${partido.equipoVisitante}">Visitante</span>
                                    </p>
                                    <p class="text-xs text-gray-500">
                                        <span th:text="${#temporals.format(partido.fecha, 'dd/MM/yyyy')}">Fecha</span>
                                        <span th:text="${#temporals.format(partido.hora, 'HH:mm')}">Hora</span>
                                    </p>
                                </div>
                                
                                <div class="text-right">
                                    <p class="text-xs text-gray-500" th:text="${partido.cancha}">Cancha</p>
                                    <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">
                                        <span th:text="${partido.estado.displayName}">Estado</span>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
